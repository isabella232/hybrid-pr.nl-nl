---
title: Detectie patroon voor Footfall met behulp van Azure en Azure Stack hub
description: Meer informatie over het gebruik van Azure en Azure Stack hub voor het implementeren van een op AI gebaseerde Footfall detectie oplossing voor het analyseren van het verkeer van Retail Store.
author: BryanLa
ms.topic: article
ms.date: 10/31/2019
ms.author: bryanla
ms.reviewer: anajod
ms.lastreviewed: 10/31/2019
ms.openlocfilehash: 866557ec3af2337e9f034da84cf417675508563b
ms.sourcegitcommit: 962334135b63ac99c715e7bc8fb9282648ba63c9
ms.translationtype: MT
ms.contentlocale: nl-NL
ms.lasthandoff: 03/23/2021
ms.locfileid: "104895326"
---
# <a name="footfall-detection-pattern"></a><span data-ttu-id="3321c-103">Footfall-detectie patroon</span><span class="sxs-lookup"><span data-stu-id="3321c-103">Footfall detection pattern</span></span>

<span data-ttu-id="3321c-104">Dit patroon biedt een overzicht van het implementeren van een op AI gebaseerde Footfall detectie oplossing voor het analyseren van bezoekers verkeer in winkels.</span><span class="sxs-lookup"><span data-stu-id="3321c-104">This pattern provides an overview for implementing an AI-based footfall detection solution for analyzing visitor traffic in retail stores.</span></span> <span data-ttu-id="3321c-105">De oplossing genereert inzichten van praktijk acties, met behulp van Azure, Azure Stack hub en de Custom Vision AI dev kit.</span><span class="sxs-lookup"><span data-stu-id="3321c-105">The solution generates insights from real world actions, using Azure, Azure Stack Hub, and the Custom Vision AI Dev Kit.</span></span>

## <a name="context-and-problem"></a><span data-ttu-id="3321c-106">Context en probleem</span><span class="sxs-lookup"><span data-stu-id="3321c-106">Context and problem</span></span>

<span data-ttu-id="3321c-107">Contoso-winkels willen graag inzicht krijgen in hoe klanten hun huidige producten ontvangen met betrekking tot de opslag indeling.</span><span class="sxs-lookup"><span data-stu-id="3321c-107">Contoso Stores would like to gain insights on how customers are receiving their current products in relation to store layout.</span></span> <span data-ttu-id="3321c-108">Ze kunnen geen personeel in elke sectie plaatsen en het is inefficiënt om een team van analisten te laten beoordelen van de camera beelden van de hele winkel.</span><span class="sxs-lookup"><span data-stu-id="3321c-108">They're unable to place staff in every section and it's inefficient to have a team of analysts review an entire store's camera footage.</span></span> <span data-ttu-id="3321c-109">Daarnaast hebben geen van hun winkels voldoende band breedte om video van al hun camera's naar de cloud te streamen voor analyse.</span><span class="sxs-lookup"><span data-stu-id="3321c-109">In addition, none of their stores have enough bandwidth to stream video from all their cameras to the cloud for analysis.</span></span>

<span data-ttu-id="3321c-110">Contoso wil graag een onopvallende, privacy vriendelijke manier vinden om de demografische, loyaliteit en reacties van hun klanten te bepalen voor het opslaan van weer gaven en producten.</span><span class="sxs-lookup"><span data-stu-id="3321c-110">Contoso would like to find an unobtrusive, privacy-friendly way to determine their customers' demographics, loyalty, and reactions to store displays and products.</span></span>

## <a name="solution"></a><span data-ttu-id="3321c-111">Oplossing</span><span class="sxs-lookup"><span data-stu-id="3321c-111">Solution</span></span>

<span data-ttu-id="3321c-112">In dit retail Analytics-patroon wordt gebruikgemaakt van een gelaagde benadering voor het afwijzen van de rand.</span><span class="sxs-lookup"><span data-stu-id="3321c-112">This retail analytics pattern uses a tiered approach to inferencing at the edge.</span></span> <span data-ttu-id="3321c-113">Door gebruik te maken van de Custom Vision AI dev kit, worden alleen afbeeldingen met menselijke gezichten verzonden voor analyse naar een privé Azure Stack hub die Azure Cognitive Services uitvoert.</span><span class="sxs-lookup"><span data-stu-id="3321c-113">By using the Custom Vision AI Dev Kit, only images with human faces are sent for analysis to a private Azure Stack Hub that runs Azure Cognitive Services.</span></span> <span data-ttu-id="3321c-114">Geanonimiseerd, geaggregeerde gegevens worden naar Azure verzonden voor aggregatie over alle archieven en visualisaties in Power BI.</span><span class="sxs-lookup"><span data-stu-id="3321c-114">Anonymized, aggregated data is sent to Azure for aggregation across all stores and visualization in Power BI.</span></span> <span data-ttu-id="3321c-115">Door de rand en open bare Cloud te combi neren, kunnen we profiteren van de moderne AI-technologie, terwijl ze ook in overeenstemming zijn met hun bedrijfs beleid en de privacy van hun klanten eerbiedigen.</span><span class="sxs-lookup"><span data-stu-id="3321c-115">Combining the edge and public cloud lets Contoso take advantage of modern AI technology while also remaining in compliance with their corporate policies and respecting their customers' privacy.</span></span>

<span data-ttu-id="3321c-116">[![Oplossing voor Footfall-detectie patroon](media/pattern-retail-footfall-detection/solution-architecture.png)](media/pattern-retail-footfall-detection/solution-architecture.png)</span><span class="sxs-lookup"><span data-stu-id="3321c-116">[![Footfall detection pattern solution](media/pattern-retail-footfall-detection/solution-architecture.png)](media/pattern-retail-footfall-detection/solution-architecture.png)</span></span>

<span data-ttu-id="3321c-117">Hier volgt een overzicht van de werking van de oplossing:</span><span class="sxs-lookup"><span data-stu-id="3321c-117">Here's a summary of how the solution works:</span></span>

1. <span data-ttu-id="3321c-118">De Custom Vision AI dev kit haalt een configuratie op van IoT Hub, waarmee de IoT Edge runtime en een ML-model worden geïnstalleerd.</span><span class="sxs-lookup"><span data-stu-id="3321c-118">The Custom Vision AI Dev Kit gets a configuration from IoT Hub, which installs the IoT Edge Runtime and an ML model.</span></span>
2. <span data-ttu-id="3321c-119">Als het model een persoon ziet, neemt het een foto mee en uploadt deze naar Azure Stack hub-Blob-opslag.</span><span class="sxs-lookup"><span data-stu-id="3321c-119">If the model sees a person, it takes a picture and uploads it to Azure Stack Hub blob storage.</span></span>
3. <span data-ttu-id="3321c-120">De BLOB-service activeert een Azure-functie op Azure Stack hub.</span><span class="sxs-lookup"><span data-stu-id="3321c-120">The blob service triggers an Azure Function on Azure Stack Hub.</span></span>
4. <span data-ttu-id="3321c-121">De Azure-functie roept een container met de Face-API op om demografische-en Emotion-gegevens op te halen uit de installatie kopie.</span><span class="sxs-lookup"><span data-stu-id="3321c-121">The Azure Function calls a container with the Face API to get demographic and emotion data from the image.</span></span>
5. <span data-ttu-id="3321c-122">De gegevens worden geanonimiseerd en verzonden naar een Azure Event Hubs-cluster.</span><span class="sxs-lookup"><span data-stu-id="3321c-122">The data is anonymized and sent to an Azure Event Hubs cluster.</span></span>
6. <span data-ttu-id="3321c-123">Het Event Hubs cluster duwt de gegevens naar Stream Analytics.</span><span class="sxs-lookup"><span data-stu-id="3321c-123">The Event Hubs cluster pushes the data to Stream Analytics.</span></span>
7. <span data-ttu-id="3321c-124">Stream Analytics worden de gegevens geaggregeerd en naar Power BI gepusht.</span><span class="sxs-lookup"><span data-stu-id="3321c-124">Stream Analytics aggregates the data and pushes it to Power BI.</span></span>

## <a name="components"></a><span data-ttu-id="3321c-125">Onderdelen</span><span class="sxs-lookup"><span data-stu-id="3321c-125">Components</span></span>

<span data-ttu-id="3321c-126">Deze oplossing maakt gebruik van de volgende onderdelen:</span><span class="sxs-lookup"><span data-stu-id="3321c-126">This solution uses the following components:</span></span>

| <span data-ttu-id="3321c-127">Laag</span><span class="sxs-lookup"><span data-stu-id="3321c-127">Layer</span></span> | <span data-ttu-id="3321c-128">Onderdeel</span><span class="sxs-lookup"><span data-stu-id="3321c-128">Component</span></span> | <span data-ttu-id="3321c-129">Beschrijving</span><span class="sxs-lookup"><span data-stu-id="3321c-129">Description</span></span> |
|----------|-----------|-------------|
| <span data-ttu-id="3321c-130">Hardware in de Store</span><span class="sxs-lookup"><span data-stu-id="3321c-130">In-store hardware</span></span> | [<span data-ttu-id="3321c-131">Custom Vision AI dev kit</span><span class="sxs-lookup"><span data-stu-id="3321c-131">Custom Vision AI Dev Kit</span></span>](https://azure.github.io/Vision-AI-DevKit-Pages/) | <span data-ttu-id="3321c-132">Biedt in-Store filtering met behulp van een lokaal ML-model dat alleen installatie kopieën van mensen vastlegt voor analyse.</span><span class="sxs-lookup"><span data-stu-id="3321c-132">Provides in-store filtering using a local ML model that only captures images of people for analysis.</span></span> <span data-ttu-id="3321c-133">Veilig ingericht en bijgewerkt via IoT Hub.</span><span class="sxs-lookup"><span data-stu-id="3321c-133">Securely provisioned and updated through IoT Hub.</span></span><br><br>|
| <span data-ttu-id="3321c-134">Azure</span><span class="sxs-lookup"><span data-stu-id="3321c-134">Azure</span></span> | [<span data-ttu-id="3321c-135">Azure Event Hubs</span><span class="sxs-lookup"><span data-stu-id="3321c-135">Azure Event Hubs</span></span>](/azure/event-hubs/) | <span data-ttu-id="3321c-136">Azure Event Hubs biedt een schaalbaar platform voor het opnemen van geanonimiseerd-gegevens die netjes worden geïntegreerd met Azure Stream Analytics.</span><span class="sxs-lookup"><span data-stu-id="3321c-136">Azure Event Hubs provides a scalable platform for ingesting anonymized data that integrates neatly with Azure Stream Analytics.</span></span> |
|  | [<span data-ttu-id="3321c-137">Azure Stream Analytics</span><span class="sxs-lookup"><span data-stu-id="3321c-137">Azure Stream Analytics</span></span>](/azure/stream-analytics/) | <span data-ttu-id="3321c-138">Een Azure Stream Analytics taak aggregeert de geanonimiseerd-gegevens en groepeert deze in 15-Second Windows voor visualisatie.</span><span class="sxs-lookup"><span data-stu-id="3321c-138">An Azure Stream Analytics job aggregates the anonymized data and groups it into 15-second windows for visualization.</span></span> |
|  | [<span data-ttu-id="3321c-139">Microsoft Power BI</span><span class="sxs-lookup"><span data-stu-id="3321c-139">Microsoft Power BI</span></span>](https://powerbi.microsoft.com/) | <span data-ttu-id="3321c-140">Power BI biedt een gebruiks vriendelijke dash board-interface voor het weer geven van de uitvoer van Azure Stream Analytics.</span><span class="sxs-lookup"><span data-stu-id="3321c-140">Power BI provides an easy-to-use dashboard interface for viewing the output from Azure Stream Analytics.</span></span> |
| <span data-ttu-id="3321c-141">Azure Stack Hub</span><span class="sxs-lookup"><span data-stu-id="3321c-141">Azure Stack Hub</span></span> | [<span data-ttu-id="3321c-142">App Service</span><span class="sxs-lookup"><span data-stu-id="3321c-142">App Service</span></span>](/azure-stack/operator/azure-stack-app-service-overview) | <span data-ttu-id="3321c-143">De App Service Resource provider (RP) biedt een basis voor Edge-onderdelen, waaronder hosting-en beheer functies voor web-apps/Api's en functies.</span><span class="sxs-lookup"><span data-stu-id="3321c-143">The App Service resource provider (RP) provides a base for edge components, including hosting and management features for web apps/APIs and Functions.</span></span> |
| | <span data-ttu-id="3321c-144">Azure Kubernetes service [(AKS) engine-](https://github.com/Azure/aks-engine) cluster</span><span class="sxs-lookup"><span data-stu-id="3321c-144">Azure Kubernetes Service [(AKS) Engine](https://github.com/Azure/aks-engine) cluster</span></span> | <span data-ttu-id="3321c-145">De AKS RP met AKS-Engine cluster dat is geïmplementeerd in Azure Stack hub biedt een schaal bare, robuuste engine voor het uitvoeren van de Face-API-container.</span><span class="sxs-lookup"><span data-stu-id="3321c-145">The AKS RP with AKS-Engine cluster deployed into Azure Stack Hub provides a scalable, resilient engine to run the Face API container.</span></span> |
| | <span data-ttu-id="3321c-146">Azure Cognitive Services [Face-API-containers](/azure/cognitive-services/face/face-how-to-install-containers)</span><span class="sxs-lookup"><span data-stu-id="3321c-146">Azure Cognitive Services [Face API containers](/azure/cognitive-services/face/face-how-to-install-containers)</span></span>| <span data-ttu-id="3321c-147">De Azure Cognitive Services RP met Face-API-containers biedt demografische, Emotion en unieke detectie van bezoekers op het particuliere netwerk van contoso.</span><span class="sxs-lookup"><span data-stu-id="3321c-147">The Azure Cognitive Services RP with Face API containers provides demographic, emotion, and unique visitor detection on Contoso's private network.</span></span> |
| | <span data-ttu-id="3321c-148">Blob Storage</span><span class="sxs-lookup"><span data-stu-id="3321c-148">Blob Storage</span></span> | <span data-ttu-id="3321c-149">Installatie kopieën die zijn vastgelegd in de AI dev kit, worden geüpload naar de Blob-opslag van Azure Stack hub.</span><span class="sxs-lookup"><span data-stu-id="3321c-149">Images captured from the AI Dev Kit are uploaded to Azure Stack Hub's blob storage.</span></span> |
| | <span data-ttu-id="3321c-150">Azure Functions</span><span class="sxs-lookup"><span data-stu-id="3321c-150">Azure Functions</span></span> | <span data-ttu-id="3321c-151">Een Azure-functie die wordt uitgevoerd op Azure Stack hub ontvangt invoer van Blob Storage en beheert de interacties met de Face-API.</span><span class="sxs-lookup"><span data-stu-id="3321c-151">An Azure Function running on Azure Stack Hub receives input from blob storage and manages the interactions with the Face API.</span></span> <span data-ttu-id="3321c-152">Het verzendt geanonimiseerd-gegevens naar een Event Hubs-cluster dat zich in azure bevindt.</span><span class="sxs-lookup"><span data-stu-id="3321c-152">It emits anonymized data to an Event Hubs cluster located in Azure.</span></span><br><br>|

## <a name="issues-and-considerations"></a><span data-ttu-id="3321c-153">Problemen en overwegingen</span><span class="sxs-lookup"><span data-stu-id="3321c-153">Issues and considerations</span></span>

<span data-ttu-id="3321c-154">Houd rekening met de volgende punten wanneer u bepaalt hoe u deze oplossing implementeert:</span><span class="sxs-lookup"><span data-stu-id="3321c-154">Consider the following points when deciding how to implement this solution:</span></span>

### <a name="scalability"></a><span data-ttu-id="3321c-155">Schaalbaarheid</span><span class="sxs-lookup"><span data-stu-id="3321c-155">Scalability</span></span>

<span data-ttu-id="3321c-156">Als u wilt dat deze oplossing kan worden geschaald over meerdere camera's en locaties, moet u ervoor zorgen dat alle onderdelen de toegenomen belasting kunnen afhandelen.</span><span class="sxs-lookup"><span data-stu-id="3321c-156">To enable this solution to scale across multiple cameras and locations, you'll need to make sure that all of the components can handle the increased load.</span></span> <span data-ttu-id="3321c-157">U moet mogelijk acties uitvoeren zoals:</span><span class="sxs-lookup"><span data-stu-id="3321c-157">You may need to take actions like:</span></span>

- <span data-ttu-id="3321c-158">Verhoog het aantal Stream Analytics streaming-eenheden.</span><span class="sxs-lookup"><span data-stu-id="3321c-158">Increase the number of Stream Analytics streaming units.</span></span>
- <span data-ttu-id="3321c-159">Uitschalen van de Face-API-implementatie.</span><span class="sxs-lookup"><span data-stu-id="3321c-159">Scale out the Face API deployment.</span></span>
- <span data-ttu-id="3321c-160">Verhoog de Event Hubs cluster doorvoer.</span><span class="sxs-lookup"><span data-stu-id="3321c-160">Increase the Event Hubs cluster throughput.</span></span>
- <span data-ttu-id="3321c-161">In uitzonderlijke gevallen kan het nodig zijn om van Azure Functions naar een virtuele machine te migreren.</span><span class="sxs-lookup"><span data-stu-id="3321c-161">For extreme cases, migrate from Azure Functions to a virtual machine may be necessary.</span></span>

### <a name="availability"></a><span data-ttu-id="3321c-162">Beschikbaarheid</span><span class="sxs-lookup"><span data-stu-id="3321c-162">Availability</span></span>

<span data-ttu-id="3321c-163">Omdat deze oplossing is gelaagd, is het belang rijk om te zien hoe u kunt omgaan met netwerk-of energie storingen.</span><span class="sxs-lookup"><span data-stu-id="3321c-163">Since this solution is tiered, it's important to think about how to deal with networking or power failures.</span></span> <span data-ttu-id="3321c-164">Afhankelijk van de behoeften van uw bedrijf wilt u mogelijk een mechanisme implementeren om installatie kopieën lokaal in de cache te plaatsen, waarna de Azure Stack-hub wordt doorgestuurd wanneer de verbinding wordt geretourneerd.</span><span class="sxs-lookup"><span data-stu-id="3321c-164">Depending on business needs, you might want to implement a mechanism to cache images locally, then forward to Azure Stack Hub when connectivity returns.</span></span> <span data-ttu-id="3321c-165">Als de locatie groot genoeg is, is het implementeren van een Data Box Edge met de Face-API-container naar die locatie mogelijk een betere optie.</span><span class="sxs-lookup"><span data-stu-id="3321c-165">If the location is large enough, deploying a Data Box Edge with the Face API container to that location might be a better option.</span></span>

### <a name="manageability"></a><span data-ttu-id="3321c-166">Beheerbaarheid</span><span class="sxs-lookup"><span data-stu-id="3321c-166">Manageability</span></span>

<span data-ttu-id="3321c-167">Deze oplossing kan veel apparaten en locaties omvatten, wat een onhandigheid kan oplevert.</span><span class="sxs-lookup"><span data-stu-id="3321c-167">This solution can span many devices and locations, which could get unwieldy.</span></span> <span data-ttu-id="3321c-168">[De IOT-services van Azure](/azure/iot-fundamentals/) kunnen worden gebruikt om automatisch nieuwe locaties en apparaten online te brengen en deze up-to-date te houden.</span><span class="sxs-lookup"><span data-stu-id="3321c-168">[Azure's IoT services](/azure/iot-fundamentals/) can be used to automatically bring new locations and devices online and keep them up to date.</span></span>

### <a name="security"></a><span data-ttu-id="3321c-169">Beveiliging</span><span class="sxs-lookup"><span data-stu-id="3321c-169">Security</span></span>

<span data-ttu-id="3321c-170">Met deze oplossing worden de installatie kopieën van klanten vastgelegd, waardoor de beveiliging een grootste overweging wordt.</span><span class="sxs-lookup"><span data-stu-id="3321c-170">This solution captures customer images, making security a paramount consideration.</span></span> <span data-ttu-id="3321c-171">Zorg ervoor dat alle opslag accounts zijn beveiligd met het juiste toegangs beleid en om regel matig sleutels te draaien.</span><span class="sxs-lookup"><span data-stu-id="3321c-171">Make sure all storage accounts are secured with the proper access policies and rotate keys regularly.</span></span> <span data-ttu-id="3321c-172">Zorg ervoor dat opslag accounts en Event Hubs Bewaar beleid hebben dat voldoet aan de privacyinstellingen van de bedrijfs-en regerings wetgeving.</span><span class="sxs-lookup"><span data-stu-id="3321c-172">Ensure storage accounts and Event Hubs have retention policies that meet corporate and government privacy regulations.</span></span> <span data-ttu-id="3321c-173">Zorg er ook voor dat u het toegangs niveau van de gebruiker laagt.</span><span class="sxs-lookup"><span data-stu-id="3321c-173">Also make sure to tier the user access levels.</span></span> <span data-ttu-id="3321c-174">Met lagen zorgt u ervoor dat gebruikers alleen toegang hebben tot de gegevens die ze nodig hebben voor hun rol.</span><span class="sxs-lookup"><span data-stu-id="3321c-174">Tiering ensures that users only have access to the data they need for their role.</span></span>

## <a name="next-steps"></a><span data-ttu-id="3321c-175">Volgende stappen</span><span class="sxs-lookup"><span data-stu-id="3321c-175">Next steps</span></span>

<span data-ttu-id="3321c-176">Voor meer informatie over de onderwerpen die in dit artikel worden geïntroduceerd:</span><span class="sxs-lookup"><span data-stu-id="3321c-176">To learn more about the topics introduced in this article:</span></span>

- <span data-ttu-id="3321c-177">Zie het [patroon gelaagde gegevens](https://aka.ms/tiereddatadeploy), dat wordt gebruikt door het detectie patroon Footfall.</span><span class="sxs-lookup"><span data-stu-id="3321c-177">See the [Tiered Data pattern](https://aka.ms/tiereddatadeploy), which is leveraged by the footfall detection pattern.</span></span>
- <span data-ttu-id="3321c-178">Raadpleeg de [Custom Vision AI dev kit](https://azure.github.io/Vision-AI-DevKit-Pages/) voor meer informatie over het gebruik van aangepaste visie.</span><span class="sxs-lookup"><span data-stu-id="3321c-178">See the [Custom Vision AI Dev Kit](https://azure.github.io/Vision-AI-DevKit-Pages/) to learn more about using custom vision.</span></span> 

<span data-ttu-id="3321c-179">Wanneer u klaar bent om het voor beeld van de oplossing te testen, gaat u verder met de [implementatie handleiding voor Footfall-detectie](solution-deployment-guide-retail-footfall-detection.md).</span><span class="sxs-lookup"><span data-stu-id="3321c-179">When you're ready to test the solution example, continue with the [Footfall detection deployment guide](solution-deployment-guide-retail-footfall-detection.md).</span></span> <span data-ttu-id="3321c-180">De implementatie handleiding bevat stapsgewijze instructies voor het implementeren en testen van de onderdelen.</span><span class="sxs-lookup"><span data-stu-id="3321c-180">The deployment guide provides step-by-step instructions for deploying and testing its components.</span></span>
